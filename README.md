# gbM_modelling

Scripts for:

Millennia-long epigenetic fluctuations generate intragenic DNA methylation variance in Arabidopsis populations 

and the earlier pre-print:

[Unified establishment and epigenetic inheritance of DNA methylation through cooperative MET1 activity](https://www.biorxiv.org/content/10.1101/2022.09.12.507517v1)

## How to run the code
Code written to run on a linux cluster using anaconda instalation: anaconda3-5.2.0
Sample bash scripts included, which will need modifying for the specific cluster set up. 


Download repository preserving directory structure. 
Unzip the zipped input files in place. 
To run on full 740 accessions, use input file at:
https://zenodo.org/record/7143326#.Y0PolXbMKUl
Unzip and place this in folder:
Sim_Input_Files_Final


Codes are run in three steps. 
1. Main simulation (or data analysis) code which creates output batch files (by splitting target genes into several batches)
2. ConcatFiles code which concatinates the batch files into complete output files
3. Graph scripts 

The graph scrpits use a combination of input filenames auto generated by the specified input parameters and from manually specified filenames. 
Most output files used in graph scripts are generated by the simualtion code in the same folder. Occationally another output file from a precious simualtion 
is used (for example to compare different parameterisations on the same graph); in this case the extra output file needed is already included in this repository. 

All intermediate batch files, output files and graphs are included as an example for the folder: 
Codes/WholeGene_RateFitOnly/30GenRates



## Repository DOI:
10.5281/zenodo.8332883
